datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model Repo {
    owner    String
    name     String
    branches Branch[]

    @@unique([owner, name])
}

model Branch {
    owner    String
    repoName String
    repo     Repo   @relation(fields: [owner, repoName], references: [owner, name])

    name    String
    commits Commit[]

    @@unique([owner, repoName, name])
}

model Commit {
    owner      String
    repoName   String
    branchName String
    branch     Branch @relation(fields: [owner, repoName, branchName], references: [owner, repoName, name])

    hash    String
    entries Entry[]

    @@unique([owner, repoName, branchName, hash])
}

model Entry {
    id        String   @id
    createdAt DateTime

    zigVersion String
    zlsVersion String

    owner      String
    repoName   String
    branchName String
    commitHash String
    commit     Commit @relation(fields: [owner, repoName, branchName, commitHash], references: [owner, repoName, branchName, hash])

    group   Group  @relation(fields: [groupId], references: [id])
    groupId String
}

model Group {
    id      String  @id
    summary String
    entries Entry[]
}
